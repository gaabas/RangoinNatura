<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Processador de Pedidos de Refeições Saudáveis</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
        }
        h1 {
            color: #333;
        }
        textarea {
            width: 100%;
            height: 150px;
            margin-bottom: 10px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        button {
            background-color: #4CAF50;
            border: none;
            color: white;
            padding: 10px 20px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 16px;
            margin: 4px 2px;
            cursor: pointer;
            border-radius: 4px;
        }
        #resultado {
            margin-top: 20px;
            padding: 10px;
            background-color: #f0f0f0;
            border-radius: 4px;
            white-space: pre-wrap;
        }
        #erro {
            color: red;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <h1>Processador de Pedidos de Refeições Saudáveis</h1>
    <textarea id="pedidoInput" placeholder="Insira seu pedido aqui...
Exemplo:
Combo Semanal 1
- Frango Grelhado
Acompanhamento:
- Brócolis
Combo Semanal 2
- Salmão
Acompanhamento:
- Quinoa
Turbine Seu Combo!
- Suco Verde"></textarea>
    <br>
    <button onclick="processarPedido()">Processar Pedido</button>
    <div id="erro"></div>
    <div id="resultado"></div>

    <script>
        function processarPedido() {
            const pedidoInput = document.getElementById('pedidoInput').value;
            const erroElement = document.getElementById('erro');
            const resultadoElement = document.getElementById('resultado');
            
            erroElement.textContent = '';
            resultadoElement.textContent = '';

            if (!pedidoInput.trim()) {
                erroElement.textContent = 'Por favor, insira um pedido antes de processar.';
                return;
            }

            try {
                const resultado = analisarPedido(pedidoInput);
                resultadoElement.textContent = formatarResultado(resultado);
            } catch (error) {
                erroElement.textContent = 'Erro ao processar o pedido: ' + error.message;
            }
        }

        function analisarPedido(pedidoText) {
            const linhas = pedidoText.split('\n');
            const refeicoes = {};
            const extras = [];
            let refeicaoAtual = null;
            let modoExtra = false;

            for (const linha of linhas) {
                const linhaLimpa = linha.trim();
                if (linhaLimpa.startsWith('Combo Semanal')) {
                    refeicaoAtual = null;
                    modoExtra = false;
                } else if (linhaLimpa.startsWith('- ') && !modoExtra) {
                    if (!refeicaoAtual) {
                        refeicaoAtual = linhaLimpa.substring(2);
                        refeicoes[refeicaoAtual] = refeicoes[refeicaoAtual] || { quantidade: 0, acompanhamentos: [] };
                        refeicoes[refeicaoAtual].quantidade++;
                    } else {
                        refeicoes[refeicaoAtual].acompanhamentos.push(linhaLimpa.substring(2));
                    }
                } else if (linhaLimpa === 'Turbine Seu Combo!') {
                    modoExtra = true;
                } else if (linhaLimpa.startsWith('- ') && modoExtra) {
                    extras.push(linhaLimpa.substring(2));
                }
            }

            return { refeicoes, extras };
        }

        function formatarResultado(resultado) {
            let saida = 'Pedido processado:\n';
            for (const [refeicao, dados] of Object.entries(resultado.refeicoes)) {
                saida += `${dados.quantidade} ${refeicao}`;
                if (dados.acompanhamentos.length > 0) {
                    saida += ` + ${dados.acompanhamentos.join(' + ')}`;
                }
                saida += '\n';
            }
            if (resultado.extras.length > 0) {
                saida += '\nItens extras:\n';
                for (const extra of resultado.extras) {
                    saida += `1 ${extra}\n`;
                }
            }
            return saida;
        }
    </script>
</body>
</html>